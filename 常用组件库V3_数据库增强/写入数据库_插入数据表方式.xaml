<Activity mc:Ignorable="sap sap2010 sads" x:Class="EncooWorkflow.Main" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:baast="clr-namespace:BotTime.ActivityLibrary.Activities.System.Tool;assembly=BotTime.ActivityLibrary" xmlns:bda="clr-namespace:BotTime.DataBase.Activity;assembly=BotTime.DataBase.Activity" xmlns:bda1="clr-namespace:BotTime.DataTableActivity.Activities;assembly=BotTime.DataTableActivity" xmlns:bfa="clr-namespace:BotTime.Flow.Activities;assembly=BotTime.Flow.Activities" xmlns:eae="clr-namespace:Encootech.ActivityCommon.EncooCommonActivity;assembly=ActivityCommon" xmlns:ecaac="clr-namespace:Encoo.CodeTool.Activity.Activities.Collection;assembly=Encoo.CodeTool.Activity" xmlns:mca="clr-namespace:Microsoft.CSharp.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:this="clr-namespace:EncooWorkflow" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:常="clr-namespace:常用组件库V3_日志增强;assembly=%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6%E5%BA%93V3_%E6%97%A5%E5%BF%97%E5%A2%9E%E5%BC%BA" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger">
  <x:Members>
    <x:Property Name="数据表" Type="InArgument(sd:DataTable)" />
    <x:Property Name="数据表字段配置映射一层字典" Type="InArgument(scg:Dictionary(x:String, scg:Dictionary(x:String, scg:Dictionary(x:String, x:String))))" />
    <x:Property Name="模块名称" Type="InArgument(x:String)" />
    <x:Property Name="模块与对应数据表名称字典" Type="InArgument(scg:Dictionary(x:String, x:String))" />
    <x:Property Name="筛选字段List" Type="InArgument(scg:List(x:String))" />
    <x:Property Name="数据库链接文本" Type="InArgument(x:String)" />
  </x:Members>
  <this:Main.筛选字段List>
    <InArgument x:TypeArguments="scg:List(x:String)">
      <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_14">new List&lt;String&gt;{"店铺ID","日期"}</mca:CSharpValue>
    </InArgument>
  </this:Main.筛选字段List>
  <sap2010:ExpressionActivityEditor.ExpressionActivityEditor>C#</sap2010:ExpressionActivityEditor.ExpressionActivityEditor>
  <sap:VirtualizedContainerService.HintSize>690,5212</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>EncooWorkflow.defaultWorkflowSequence</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="14">
      <x:String>System</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>BotTime.ActivityLibrary.Activities.System.Tool</x:String>
      <x:String>BotTime.DataTableActivity.Activities</x:String>
      <x:String>BotTime.Flow.Activities</x:String>
      <x:String>Microsoft.CSharp.Activities</x:String>
      <x:String>Encoo.CodeTool.Activity.Activities.Collection</x:String>
      <x:String>BotTime.DataBase.Activity</x:String>
      <x:String>Encootech.ActivityCommon.EncooCommonActivity</x:String>
      <x:String>常用组件库V3_日志增强</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>netstandard</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>Microsoft.Bcl.AsyncInterfaces</AssemblyReference>
      <AssemblyReference>BotTime.ActivityLibrary</AssemblyReference>
      <AssemblyReference>BotTime.DataTableActivity</AssemblyReference>
      <AssemblyReference>BotTime.Flow.Activities</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Encoo.CodeTool.Activity</AssemblyReference>
      <AssemblyReference>BotTime.DataBase.Activity</AssemblyReference>
      <AssemblyReference>ActivityCommon</AssemblyReference>
      <AssemblyReference>%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6%E5%BA%93V3_%E6%97%A5%E5%BF%97%E5%A2%9E%E5%BC%BA</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Sequence DisplayName="序列_Root" sap:VirtualizedContainerService.HintSize="650,5132" sap2010:WorkflowViewState.IdRef="Sequence_2">
    <Sequence.Variables>
      <Variable x:TypeArguments="x:String" Name="where子句" />
      <Variable x:TypeArguments="x:String" Name="查询SQL" />
      <Variable x:TypeArguments="x:String" Name="删除SQL" />
    </Sequence.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="628,58" sap2010:WorkflowViewState.IdRef="LogActivity_24" Level="Info">
      <baast:LogActivity.LogContent>
        <InArgument x:TypeArguments="x:String">
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_49">=====写入数据库_插入数据表方式，开始执行=====</Literal>
        </InArgument>
      </baast:LogActivity.LogContent>
    </baast:LogActivity>
    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="628,58" sap2010:WorkflowViewState.IdRef="LogActivity_25" Level="Info">
      <baast:LogActivity.LogContent>
        <InArgument x:TypeArguments="x:String">
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_37">----判断数据表是否为空----</Literal>
        </InArgument>
      </baast:LogActivity.LogContent>
    </baast:LogActivity>
    <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="IF-判断数据表是否为空" sap:VirtualizedContainerService.HintSize="628,53" sap2010:WorkflowViewState.IdRef="If_3" IsIgnore="False">
      <bfa:If.Condition>
        <InArgument x:TypeArguments="x:Boolean">
          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_174">数据表.Rows.Count==0</mca:CSharpValue>
        </InArgument>
      </bfa:If.Condition>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <bfa:If.Then>
        <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,244" sap2010:WorkflowViewState.IdRef="Sequence_26">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_23" Level="Error">
            <baast:LogActivity.LogContent>
              <InArgument x:TypeArguments="x:String">
                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_31">数据表为空，跳出写库。</Literal>
              </InArgument>
            </baast:LogActivity.LogContent>
          </baast:LogActivity>
          <bfa:Abort ActivityName="终止流程" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="终止流程" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="Abort_1" IsIgnore="False" />
        </Sequence>
      </bfa:If.Then>
    </bfa:If>
    <bfa:TryCatch ActivityName="错误捕获（Try Catch）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="Try Catch-数值格式标准化" sap:VirtualizedContainerService.HintSize="628,53" sap2010:WorkflowViewState.IdRef="TryCatch_1" IsIgnore="False">
      <bfa:TryCatch.Variables>
        <Variable x:TypeArguments="x:String" Name="列名" />
        <Variable x:TypeArguments="x:String" Name="字段类型" />
        <Variable x:TypeArguments="x:Int32" Name="intColumnIndex" />
        <Variable x:TypeArguments="x:Int32" Name="intRowIndex" />
      </bfa:TryCatch.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <bfa:TryCatch.Try>
        <Sequence DisplayName="序列-Try" sap:VirtualizedContainerService.HintSize="371,337" sap2010:WorkflowViewState.IdRef="Sequence_3">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_26" Level="Info">
            <baast:LogActivity.LogContent>
              <InArgument x:TypeArguments="x:String">
                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_50">----数值格式标准化----</Literal>
              </InArgument>
            </baast:LogActivity.LogContent>
          </baast:LogActivity>
          <bfa:ForPro ActivityName="重复操作" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="重复操作-遍历每一列" sap:VirtualizedContainerService.HintSize="349,53" sap2010:WorkflowViewState.IdRef="ForPro_2" IsIgnore="False">
            <bfa:ForPro.CurrentNumber>
              <OutArgument x:TypeArguments="x:Int32">
                <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_171">intColumnIndex</mca:CSharpReference>
              </OutArgument>
            </bfa:ForPro.CurrentNumber>
            <bfa:ForPro.Cycles>
              <InArgument x:TypeArguments="x:Int32">
                <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_236">数据表.Columns.Count</mca:CSharpValue>
              </InArgument>
            </bfa:ForPro.Cycles>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <Flowchart DisplayName="Flowchart-根据字段类型选择不同处理方式" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Flowchart_2">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">460,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">80,48</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">500,50.5 500,80.5 580,80.5 580,90</av:PointCollection>
                  <x:Double x:Key="Width">976</x:Double>
                  <x:Double x:Key="Height">854</x:Double>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID6</x:Reference>
              </Flowchart.StartNode>
              <FlowDecision x:Name="__ReferenceID3" DisplayName="判断是否为数值格式" sap:VirtualizedContainerService.HintSize="112,87">
                <FlowDecision.Condition>
                  <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_257">字段类型 == "varchar" || 字段类型 == "datetime" || 字段类型 == "date"</mca:CSharpValue>
                </FlowDecision.Condition>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <av:Point x:Key="ShapeLocation">465,483</av:Point>
                    <av:Size x:Key="ShapeSize">112,87</av:Size>
                    <av:PointCollection x:Key="FalseConnector">577,526.5 774.5,526.5 774.5,610</av:PointCollection>
                    <av:PointCollection x:Key="TrueConnector">465,526.5 374.5,526.5 374.5,610</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <FlowDecision.True>
                  <FlowStep x:Name="__ReferenceID0">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">200,610</av:Point>
                        <av:Size x:Key="ShapeSize">349,58</av:Size>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_40" Level="Info">
                      <baast:LogActivity.LogContent>
                        <InArgument x:TypeArguments="x:String">
                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_258">System.Convert.ToString("【"+列名+"】不是数值格式，不处理。")</mca:CSharpValue>
                        </InArgument>
                      </baast:LogActivity.LogContent>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <av:Point x:Key="ShapeLocation">-1,-1</av:Point>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </baast:LogActivity>
                  </FlowStep>
                </FlowDecision.True>
                <FlowDecision.False>
                  <FlowStep x:Name="__ReferenceID1">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">600,610</av:Point>
                        <av:Size x:Key="ShapeSize">349,58</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">774.5,668 774.5,698 700,698 700,708</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_41" Level="Info">
                      <baast:LogActivity.LogContent>
                        <InArgument x:TypeArguments="x:String">
                          <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_259">System.Convert.ToString("【"+列名+"】是数值格式，进行处理。")</mca:CSharpValue>
                        </InArgument>
                      </baast:LogActivity.LogContent>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <av:Point x:Key="ShapeLocation">-1,-1</av:Point>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </baast:LogActivity>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID2">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">600,708</av:Point>
                            <av:Size x:Key="ShapeSize">200,53</av:Size>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:InvokeWorkflow ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="调用子流程: 数据表每一行对应列数值标准化" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="InvokeWorkflow_2" IsIgnore="False">
                          <bfa:InvokeWorkflow.Arguments>
                            <InOutArgument x:TypeArguments="sd:DataTable" x:Key="ioDTTemp">
                              <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_189">数据表</mca:CSharpReference>
                            </InOutArgument>
                            <InArgument x:TypeArguments="x:Int32" x:Key="inIntColumnIndex">
                              <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_262">intColumnIndex</mca:CSharpValue>
                            </InArgument>
                          </bfa:InvokeWorkflow.Arguments>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <bfa:InvokeWorkflow.WorkflowPath>
                            <InArgument x:TypeArguments="x:String">
                              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_52">.code\数据表每一行对应列数值标准化.xaml</Literal>
                            </InArgument>
                          </bfa:InvokeWorkflow.WorkflowPath>
                        </bfa:InvokeWorkflow>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowDecision.False>
              </FlowDecision>
              <x:Reference>__ReferenceID0</x:Reference>
              <x:Reference>__ReferenceID1</x:Reference>
              <x:Reference>__ReferenceID2</x:Reference>
              <FlowStep x:Name="__ReferenceID6">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">400,90</av:Point>
                    <av:Size x:Key="ShapeSize">360,91</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">580,181 580,221</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-序号-1才是列索引" sap:VirtualizedContainerService.HintSize="360,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_30" IsIgnore="False" Text="[{&quot;To&quot;:&quot;intColumnIndex&quot;,&quot;ToTypeName&quot;:&quot;System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;intColumnIndex-1&quot;,&quot;ValTypeName&quot;:&quot;System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                  <bfa:MultipleAssign.AssignModels>
                    <bfa:AssignModel Index="1" IsNotFirst="False">
                      <bfa:AssignModel.To>
                        <OutArgument x:TypeArguments="x:Int32">
                          <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_194">intColumnIndex</mca:CSharpReference>
                        </OutArgument>
                      </bfa:AssignModel.To>
                      <bfa:AssignModel.Value>
                        <InArgument x:TypeArguments="x:Int32">
                          <mca:CSharpValue x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpValue`1_275">intColumnIndex-1</mca:CSharpValue>
                        </InArgument>
                      </bfa:AssignModel.Value>
                    </bfa:AssignModel>
                  </bfa:MultipleAssign.AssignModels>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </bfa:MultipleAssign>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID4">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">400,221</av:Point>
                        <av:Size x:Key="ShapeSize">360,91</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">580,312 580,352</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-列名" sap:VirtualizedContainerService.HintSize="360,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_31" IsIgnore="False" Text="[{&quot;To&quot;:&quot;列名&quot;,&quot;ToTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;数据表.Columns[intColumnIndex].ToString()&quot;,&quot;ValTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                      <bfa:MultipleAssign.AssignModels>
                        <bfa:AssignModel Index="1" IsNotFirst="False">
                          <bfa:AssignModel.To>
                            <OutArgument x:TypeArguments="x:String">
                              <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_195">列名</mca:CSharpReference>
                            </OutArgument>
                          </bfa:AssignModel.To>
                          <bfa:AssignModel.Value>
                            <InArgument x:TypeArguments="x:String">
                              <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_276">数据表.Columns[intColumnIndex].ToString()</mca:CSharpValue>
                            </InArgument>
                          </bfa:AssignModel.Value>
                        </bfa:AssignModel>
                      </bfa:MultipleAssign.AssignModels>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </bfa:MultipleAssign>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID5">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">400,352</av:Point>
                            <av:Size x:Key="ShapeSize">360,91</av:Size>
                            <av:PointCollection x:Key="ConnectorLocation">580,443 580,473 521,473 521,483</av:PointCollection>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-字段类型" sap:VirtualizedContainerService.HintSize="360,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_32" IsIgnore="False" Text="[{&quot;To&quot;:&quot;字段类型&quot;,&quot;ToTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;数据表字段配置映射一层字典[模块名称][列名][\&quot;字段类型\&quot;]&quot;,&quot;ValTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                          <bfa:MultipleAssign.AssignModels>
                            <bfa:AssignModel Index="1" IsNotFirst="False">
                              <bfa:AssignModel.To>
                                <OutArgument x:TypeArguments="x:String">
                                  <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_196">字段类型</mca:CSharpReference>
                                </OutArgument>
                              </bfa:AssignModel.To>
                              <bfa:AssignModel.Value>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_277">数据表字段配置映射一层字典[模块名称][列名]["字段类型"]</mca:CSharpValue>
                                </InArgument>
                              </bfa:AssignModel.Value>
                            </bfa:AssignModel>
                          </bfa:MultipleAssign.AssignModels>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                        </bfa:MultipleAssign>
                        <FlowStep.Next>
                          <x:Reference>__ReferenceID3</x:Reference>
                        </FlowStep.Next>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
              <x:Reference>__ReferenceID4</x:Reference>
              <x:Reference>__ReferenceID5</x:Reference>
            </Flowchart>
          </bfa:ForPro>
          <常:打印数据表 sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="打印数据表_1" Level="Info">
            <常:打印数据表.传入的数据表>
              <InArgument x:TypeArguments="sd:DataTable">
                <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_184">数据表</mca:CSharpValue>
              </InArgument>
            </常:打印数据表.传入的数据表>
            <常:打印数据表.数据表名称>
              <InArgument x:TypeArguments="x:String">
                <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_33">修改单元格内容形式后的数据表</Literal>
              </InArgument>
            </常:打印数据表.数据表名称>
          </常:打印数据表>
        </Sequence>
      </bfa:TryCatch.Try>
      <bfa:TryCatch.Catches>
        <bfa:Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="435,23">
          <bfa:Catch.Action>
            <ActivityAction x:TypeArguments="s:Exception">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
              </ActivityAction.Argument>
              <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="371,636" sap2010:WorkflowViewState.IdRef="Sequence_25">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_18" Level="Error">
                  <baast:LogActivity.LogContent>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_151">System.Convert.ToString("列名="+列名)</mca:CSharpValue>
                    </InArgument>
                  </baast:LogActivity.LogContent>
                </baast:LogActivity>
                <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_19" Level="Error">
                  <baast:LogActivity.LogContent>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_152">System.Convert.ToString("字段类型="+字段类型)</mca:CSharpValue>
                    </InArgument>
                  </baast:LogActivity.LogContent>
                </baast:LogActivity>
                <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_20" Level="Error">
                  <baast:LogActivity.LogContent>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_153">System.Convert.ToString("columnIndex="+intColumnIndex)</mca:CSharpValue>
                    </InArgument>
                  </baast:LogActivity.LogContent>
                </baast:LogActivity>
                <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_21" Level="Error">
                  <baast:LogActivity.LogContent>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_154">System.Convert.ToString("rowIndex="+intRowIndex)</mca:CSharpValue>
                    </InArgument>
                  </baast:LogActivity.LogContent>
                </baast:LogActivity>
                <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_22" Level="Error">
                  <baast:LogActivity.LogContent>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_170">System.Convert.ToString("模块名称="+模块名称)</mca:CSharpValue>
                    </InArgument>
                  </baast:LogActivity.LogContent>
                </baast:LogActivity>
                <bfa:Rethrow DisplayName="重新抛出异常" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="Rethrow_1" />
              </Sequence>
            </ActivityAction>
          </bfa:Catch.Action>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
        </bfa:Catch>
      </bfa:TryCatch.Catches>
    </bfa:TryCatch>
    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="628,58" sap2010:WorkflowViewState.IdRef="LogActivity_27" Level="Info">
      <baast:LogActivity.LogContent>
        <InArgument x:TypeArguments="x:String">
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_39">----处理筛选字段----</Literal>
        </InArgument>
      </baast:LogActivity.LogContent>
    </baast:LogActivity>
    <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="IF-处理筛选字段" sap:VirtualizedContainerService.HintSize="628,318" sap2010:WorkflowViewState.IdRef="If_4" IsIgnore="False">
      <bfa:If.Condition>
        <InArgument x:TypeArguments="x:Boolean">
          <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_202">筛选字段List.Count==0</mca:CSharpValue>
        </InArgument>
      </bfa:If.Condition>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <bfa:If.Then>
        <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_31" Level="Info">
          <baast:LogActivity.LogContent>
            <InArgument x:TypeArguments="x:String">
              <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_43">筛选字段List.Count==0，不创建查询和删除SQL。</Literal>
            </InArgument>
          </baast:LogActivity.LogContent>
        </baast:LogActivity>
      </bfa:If.Then>
      <bfa:If.Else>
        <Sequence DisplayName="序列-Else" sap:VirtualizedContainerService.HintSize="222,270" sap2010:WorkflowViewState.IdRef="Sequence_27">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Sequence DisplayName="序列-构建where子句" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Sequence_28">
            <Sequence.Variables>
              <Variable x:TypeArguments="scg:List(x:String)" Name="筛选条件List">
                <Variable.Default>
                  <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_203">new List&lt;String&gt;{}</mca:CSharpValue>
                </Variable.Default>
              </Variable>
            </Sequence.Variables>
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <bfa:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" ActivityName="循环操作（For Each）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="For Each-构建筛选条件" sap:VirtualizedContainerService.HintSize="360,53" sap2010:WorkflowViewState.IdRef="ForEach`1_14" IsIgnore="False">
              <bfa:ForEach.Values>
                <InArgument x:TypeArguments="scg:List(x:String)">
                  <mca:CSharpValue x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpValue`1_204">筛选字段List</mca:CSharpValue>
                </InArgument>
              </bfa:ForEach.Values>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <ActivityAction x:TypeArguments="x:String">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="x:String" Name="字段名称" />
                </ActivityAction.Argument>
                <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="222,146" sap2010:WorkflowViewState.IdRef="Sequence_30">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ecaac:AddToCollectionActivity ActivityName="添加对象" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加对象" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="AddToCollectionActivity_2">
                    <ecaac:AddToCollectionActivity.Collection>
                      <InOutArgument x:TypeArguments="scg:List(x:String)">
                        <mca:CSharpReference x:TypeArguments="scg:List(x:String)" sap2010:WorkflowViewState.IdRef="CSharpReference`1_150">筛选条件List</mca:CSharpReference>
                      </InOutArgument>
                    </ecaac:AddToCollectionActivity.Collection>
                    <ecaac:AddToCollectionActivity.Item>
                      <InArgument x:TypeArguments="x:String">
                        <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_210">[数据表字段配置映射一层字典[模块名称][字段名称]["数据库表字段名称"]+"="+"\""+数据表.Rows[0][字段名称]+"\""]</mca:CSharpValue>
                      </InArgument>
                    </ecaac:AddToCollectionActivity.Item>
                  </ecaac:AddToCollectionActivity>
                </Sequence>
              </ActivityAction>
            </bfa:ForEach>
            <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值（多个）-拼接筛选条件" sap:VirtualizedContainerService.HintSize="360,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_22" IsIgnore="False" Text="[{&quot;To&quot;:&quot;where子句&quot;,&quot;ToTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;\&quot; WHERE \&quot;+String.Join(\&quot; AND \&quot;,筛选条件List)+\&quot;;\&quot;&quot;,&quot;ValTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
              <bfa:MultipleAssign.AssignModels>
                <bfa:AssignModel Index="1" IsNotFirst="False">
                  <bfa:AssignModel.To>
                    <OutArgument x:TypeArguments="x:String">
                      <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_191">where子句</mca:CSharpReference>
                    </OutArgument>
                  </bfa:AssignModel.To>
                  <bfa:AssignModel.Value>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_272">" WHERE "+String.Join(" AND ",筛选条件List)+";"</mca:CSharpValue>
                    </InArgument>
                  </bfa:AssignModel.Value>
                </bfa:AssignModel>
              </bfa:MultipleAssign.AssignModels>
            </bfa:MultipleAssign>
          </Sequence>
          <Sequence DisplayName="序列-构建查询、删除SQL" sap:VirtualizedContainerService.HintSize="200,53" sap2010:WorkflowViewState.IdRef="Sequence_29">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值（多个）" sap:VirtualizedContainerService.HintSize="360,121" sap2010:WorkflowViewState.IdRef="MultipleAssign_23" IsIgnore="False" Text="[{&quot;To&quot;:&quot;查询SQL&quot;,&quot;ToTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;\&quot;SELECT * FROM \&quot;+模块与对应数据表名称字典[模块名称]+\&quot; \&quot;+where子句&quot;,&quot;ValTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;},{&quot;To&quot;:&quot;删除SQL&quot;,&quot;ToTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;\&quot;DELETE FROM \&quot;+模块与对应数据表名称字典[模块名称]+\&quot; \&quot;+where子句&quot;,&quot;ValTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
              <bfa:MultipleAssign.AssignModels>
                <bfa:AssignModel Index="1" IsNotFirst="False">
                  <bfa:AssignModel.To>
                    <OutArgument x:TypeArguments="x:String">
                      <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_192">查询SQL</mca:CSharpReference>
                    </OutArgument>
                  </bfa:AssignModel.To>
                  <bfa:AssignModel.Value>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_273">"SELECT * FROM "+模块与对应数据表名称字典[模块名称]+" "+where子句</mca:CSharpValue>
                    </InArgument>
                  </bfa:AssignModel.Value>
                </bfa:AssignModel>
                <bfa:AssignModel Index="2" IsNotFirst="True">
                  <bfa:AssignModel.To>
                    <OutArgument x:TypeArguments="x:String">
                      <mca:CSharpReference x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpReference`1_193">删除SQL</mca:CSharpReference>
                    </OutArgument>
                  </bfa:AssignModel.To>
                  <bfa:AssignModel.Value>
                    <InArgument x:TypeArguments="x:String">
                      <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_274">"DELETE FROM "+模块与对应数据表名称字典[模块名称]+" "+where子句</mca:CSharpValue>
                    </InArgument>
                  </bfa:AssignModel.Value>
                </bfa:AssignModel>
              </bfa:MultipleAssign.AssignModels>
            </bfa:MultipleAssign>
            <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="360,58" sap2010:WorkflowViewState.IdRef="LogActivity_32" Level="Info">
              <baast:LogActivity.LogContent>
                <InArgument x:TypeArguments="x:String">
                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_205">System.Convert.ToString("查询SQL="+查询SQL)</mca:CSharpValue>
                </InArgument>
              </baast:LogActivity.LogContent>
            </baast:LogActivity>
            <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="360,58" sap2010:WorkflowViewState.IdRef="LogActivity_33" Level="Info">
              <baast:LogActivity.LogContent>
                <InArgument x:TypeArguments="x:String">
                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_206">System.Convert.ToString("删除SQL="+删除SQL)</mca:CSharpValue>
                </InArgument>
              </baast:LogActivity.LogContent>
            </baast:LogActivity>
          </Sequence>
        </Sequence>
      </bfa:If.Else>
    </bfa:If>
    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="628,58" sap2010:WorkflowViewState.IdRef="LogActivity_28" Level="Info">
      <baast:LogActivity.LogContent>
        <InArgument x:TypeArguments="x:String">
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_40">----构建插入数据表----</Literal>
        </InArgument>
      </baast:LogActivity.LogContent>
    </baast:LogActivity>
    <bfa:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" ActivityName="循环操作（For Each）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="For Each-数据表.Columns-构建插入数据表" sap:VirtualizedContainerService.HintSize="628,573" sap2010:WorkflowViewState.IdRef="ForEach`1_15" IsIgnore="False">
      <bfa:ForEach.Values>
        <InArgument x:TypeArguments="sd:DataColumnCollection">
          <mca:CSharpValue x:TypeArguments="sd:DataColumnCollection" sap2010:WorkflowViewState.IdRef="CSharpValue`1_270">数据表.Columns</mca:CSharpValue>
        </InArgument>
      </bfa:ForEach.Values>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ActivityAction x:TypeArguments="sd:DataColumn">
        <ActivityAction.Argument>
          <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
        </ActivityAction.Argument>
        <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="477,468" sap2010:WorkflowViewState.IdRef="Sequence_19">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <eae:CommentActivity DisplayName="注释掉" sap:VirtualizedContainerService.HintSize="455,213" sap2010:WorkflowViewState.IdRef="CommentActivity_1">
            <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_15" Level="Info">
              <baast:LogActivity.LogContent>
                <InArgument x:TypeArguments="x:String">
                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_66">System.Convert.ToString("修改数据表头："+column.ColumnName+" → "+数据表字段配置映射一层字典[模块名称][column.ColumnName]["数据库表字段名称"])</mca:CSharpValue>
                </InArgument>
              </baast:LogActivity.LogContent>
            </baast:LogActivity>
          </eae:CommentActivity>
          <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-修改列名" sap:VirtualizedContainerService.HintSize="455,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_14" IsIgnore="False" Text="[{&quot;To&quot;:&quot;数据表.Columns[column.ColumnName].ColumnName&quot;,&quot;ToTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;数据表字段配置映射一层字典[模块名称][column.ColumnName][\&quot;数据库表字段名称\&quot;]&quot;,&quot;ValTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
            <bfa:MultipleAssign.AssignModels>
              <bfa:AssignModel Index="1" IsNotFirst="False">
                <bfa:AssignModel.To>
                  <OutArgument x:TypeArguments="x:String">
                    <mca:CSharpReference x:TypeArguments="x:String">数据表.Columns[column.ColumnName].ColumnName</mca:CSharpReference>
                  </OutArgument>
                </bfa:AssignModel.To>
                <bfa:AssignModel.Value>
                  <InArgument x:TypeArguments="x:String">
                    <mca:CSharpValue x:TypeArguments="x:String">数据表字段配置映射一层字典[模块名称][column.ColumnName]["数据库表字段名称"]</mca:CSharpValue>
                  </InArgument>
                </bfa:AssignModel.Value>
              </bfa:AssignModel>
            </bfa:MultipleAssign.AssignModels>
          </bfa:MultipleAssign>
        </Sequence>
      </ActivityAction>
    </bfa:ForEach>
    <常:打印数据表 sap:VirtualizedContainerService.HintSize="628,22" sap2010:WorkflowViewState.IdRef="打印数据表_2" Level="Info">
      <常:打印数据表.传入的数据表>
        <InArgument x:TypeArguments="sd:DataTable">
          <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_183">数据表</mca:CSharpValue>
        </InArgument>
      </常:打印数据表.传入的数据表>
      <常:打印数据表.数据表名称>
        <InArgument x:TypeArguments="x:String">
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_32">数据表修改列名后</Literal>
        </InArgument>
      </常:打印数据表.数据表名称>
    </常:打印数据表>
    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="628,58" sap2010:WorkflowViewState.IdRef="LogActivity_29" Level="Info">
      <baast:LogActivity.LogContent>
        <InArgument x:TypeArguments="x:String">
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_41">----数据库操作----</Literal>
        </InArgument>
      </baast:LogActivity.LogContent>
    </baast:LogActivity>
    <Sequence DisplayName="序列-数据库操作" sap:VirtualizedContainerService.HintSize="628,3201" sap2010:WorkflowViewState.IdRef="Sequence_14">
      <Sequence.Variables>
        <Variable x:TypeArguments="sd:DataTable" Name="outputDataTable" />
      </Sequence.Variables>
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <bda:DatabaseConnectActivity ActivityName="连接数据库" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="连接数据库" sap:VirtualizedContainerService.HintSize="606,3077" sap2010:WorkflowViewState.IdRef="DatabaseConnectActivity_1" ProviderName="MySql">
        <bda:DatabaseConnectActivity.Body>
          <ActivityAction x:TypeArguments="x:Object">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="x:Object" Name="DataBaseScope" />
            </ActivityAction.Argument>
            <Sequence DisplayName="序列-数据库事务" sap:VirtualizedContainerService.HintSize="592,2969" sap2010:WorkflowViewState.IdRef="Sequence_15">
              <Sequence.Variables>
                <Variable x:TypeArguments="x:Int32" Name="affectedRows" />
              </Sequence.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <bda:ExecuteTransactionActivity ActivityName="执行事务" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行事务" sap:VirtualizedContainerService.HintSize="570,2845" sap2010:WorkflowViewState.IdRef="ExecuteTransactionActivity_1">
                <bda:ExecuteTransactionActivity.Body>
                  <ActivityAction x:TypeArguments="x:Object">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="x:Object" Name="DataBaseTransactionScope" />
                    </ActivityAction.Argument>
                    <Sequence DisplayName="序列-事务" sap:VirtualizedContainerService.HintSize="556,2759" sap2010:WorkflowViewState.IdRef="Sequence_16">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <bfa:If ActivityName="条件（If）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="IF-筛选字段是否为0" sap:VirtualizedContainerService.HintSize="534,928" sap2010:WorkflowViewState.IdRef="If_5" IsIgnore="False">
                        <bfa:If.Condition>
                          <InArgument x:TypeArguments="x:Boolean">
                            <mca:CSharpValue x:TypeArguments="x:Boolean" sap2010:WorkflowViewState.IdRef="CSharpValue`1_211">筛选字段List.Count==0</mca:CSharpValue>
                          </InArgument>
                        </bfa:If.Condition>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:If.Then>
                          <Sequence DisplayName="序列-Then" sap:VirtualizedContainerService.HintSize="477,740" sap2010:WorkflowViewState.IdRef="Sequence_31">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="455,58" sap2010:WorkflowViewState.IdRef="LogActivity_34" Level="Info">
                              <baast:LogActivity.LogContent>
                                <InArgument x:TypeArguments="x:String">
                                  <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_44">筛选字段List.Count==0，查询全表获取数据结构以便搭建插入数据表。</Literal>
                                </InArgument>
                              </baast:LogActivity.LogContent>
                            </baast:LogActivity>
                            <bfa:MultipleAssign ActivityName="赋值（多个）" sap2010:Annotation.AnnotationText="查询一条就够了。" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-查询SQL" sap:VirtualizedContainerService.HintSize="455,116" sap2010:WorkflowViewState.IdRef="MultipleAssign_24" IsIgnore="False" Text="[{&quot;To&quot;:&quot;查询SQL&quot;,&quot;ToTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;\&quot;SELECT * FROM \&quot;+模块与对应数据表名称字典[模块名称]+\&quot; LIMIT 1;\&quot;&quot;,&quot;ValTypeName&quot;:&quot;System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                              <bfa:MultipleAssign.AssignModels>
                                <bfa:AssignModel Index="1" IsNotFirst="False">
                                  <bfa:AssignModel.To>
                                    <OutArgument x:TypeArguments="x:String">
                                      <mca:CSharpReference x:TypeArguments="x:String">查询SQL</mca:CSharpReference>
                                    </OutArgument>
                                  </bfa:AssignModel.To>
                                  <bfa:AssignModel.Value>
                                    <InArgument x:TypeArguments="x:String">
                                      <mca:CSharpValue x:TypeArguments="x:String">"SELECT * FROM "+模块与对应数据表名称字典[模块名称]+" LIMIT 1;"</mca:CSharpValue>
                                    </InArgument>
                                  </bfa:AssignModel.Value>
                                </bfa:AssignModel>
                              </bfa:MultipleAssign.AssignModels>
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </bfa:MultipleAssign>
                            <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="455,58" sap2010:WorkflowViewState.IdRef="LogActivity_35" Level="Info">
                              <baast:LogActivity.LogContent>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_212">System.Convert.ToString("查询SQL="+查询SQL)</mca:CSharpValue>
                                </InArgument>
                              </baast:LogActivity.LogContent>
                            </baast:LogActivity>
                            <bda:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句-查询已存在数据" sap:VirtualizedContainerService.HintSize="455,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_2">
                              <bda:QueryTableActivity.DataTable>
                                <OutArgument x:TypeArguments="sd:DataTable">
                                  <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_151">outputDataTable</mca:CSharpReference>
                                </OutArgument>
                              </bda:QueryTableActivity.DataTable>
                              <bda:QueryTableActivity.ExecuteTimeOut>
                                <InArgument x:TypeArguments="x:TimeSpan">
                                  <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_45" Value="00:00:30" />
                                </InArgument>
                              </bda:QueryTableActivity.ExecuteTimeOut>
                              <bda:QueryTableActivity.Sql>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_213">查询SQL</mca:CSharpValue>
                                </InArgument>
                              </bda:QueryTableActivity.Sql>
                            </bda:QueryTableActivity>
                            <eae:CommentActivity sap2010:Annotation.AnnotationText="查询全表可能数据量很大，不打印了。" DisplayName="注释掉" sap:VirtualizedContainerService.HintSize="455,202" sap2010:WorkflowViewState.IdRef="CommentActivity_2">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <常:打印数据表 sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="打印数据表_5" Level="Info">
                                <常:打印数据表.传入的数据表>
                                  <InArgument x:TypeArguments="sd:DataTable">
                                    <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_217">outputDataTable</mca:CSharpValue>
                                  </InArgument>
                                </常:打印数据表.传入的数据表>
                                <常:打印数据表.数据表名称>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_48">已存在数据</Literal>
                                  </InArgument>
                                </常:打印数据表.数据表名称>
                              </常:打印数据表>
                            </eae:CommentActivity>
                          </Sequence>
                        </bfa:If.Then>
                        <bfa:If.Else>
                          <Sequence DisplayName="序列-Else" sap:VirtualizedContainerService.HintSize="371,368" sap2010:WorkflowViewState.IdRef="Sequence_32">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <bda:QueryTableActivity ActivityName="查询语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="查询语句-查询已存在数据" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="QueryTableActivity_3">
                              <bda:QueryTableActivity.DataTable>
                                <OutArgument x:TypeArguments="sd:DataTable">
                                  <mca:CSharpReference x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpReference`1_152">outputDataTable</mca:CSharpReference>
                                </OutArgument>
                              </bda:QueryTableActivity.DataTable>
                              <bda:QueryTableActivity.ExecuteTimeOut>
                                <InArgument x:TypeArguments="x:TimeSpan">
                                  <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_46" Value="00:00:30" />
                                </InArgument>
                              </bda:QueryTableActivity.ExecuteTimeOut>
                              <bda:QueryTableActivity.Sql>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_214">查询SQL</mca:CSharpValue>
                                </InArgument>
                              </bda:QueryTableActivity.Sql>
                            </bda:QueryTableActivity>
                            <常:打印数据表 sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="打印数据表_3" Level="Info">
                              <常:打印数据表.传入的数据表>
                                <InArgument x:TypeArguments="sd:DataTable">
                                  <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_185">outputDataTable</mca:CSharpValue>
                                </InArgument>
                              </常:打印数据表.传入的数据表>
                              <常:打印数据表.数据表名称>
                                <InArgument x:TypeArguments="x:String">
                                  <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_34">已存在数据</Literal>
                                </InArgument>
                              </常:打印数据表.数据表名称>
                            </常:打印数据表>
                            <bda:ExecuteSqlActivity ActivityName="执行语句" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="执行语句-删除已存在数据" sap:VirtualizedContainerService.HintSize="349,22" sap2010:WorkflowViewState.IdRef="ExecuteSqlActivity_2">
                              <bda:ExecuteSqlActivity.AffectedRows>
                                <OutArgument x:TypeArguments="x:Int32">
                                  <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_153">affectedRows</mca:CSharpReference>
                                </OutArgument>
                              </bda:ExecuteSqlActivity.AffectedRows>
                              <bda:ExecuteSqlActivity.ExecuteTimeOut>
                                <InArgument x:TypeArguments="x:TimeSpan">
                                  <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_47" Value="00:00:30" />
                                </InArgument>
                              </bda:ExecuteSqlActivity.ExecuteTimeOut>
                              <bda:ExecuteSqlActivity.Sql>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_215">删除SQL</mca:CSharpValue>
                                </InArgument>
                              </bda:ExecuteSqlActivity.Sql>
                            </bda:ExecuteSqlActivity>
                            <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="349,58" sap2010:WorkflowViewState.IdRef="LogActivity_36" Level="Info">
                              <baast:LogActivity.LogContent>
                                <InArgument x:TypeArguments="x:String">
                                  <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_216">System.Convert.ToString("删除行数="+affectedRows)</mca:CSharpValue>
                                </InArgument>
                              </baast:LogActivity.LogContent>
                            </baast:LogActivity>
                          </Sequence>
                        </bfa:If.Else>
                      </bfa:If>
                      <Sequence DisplayName="序列-遍历添加来创建结构" sap:VirtualizedContainerService.HintSize="534,1409" sap2010:WorkflowViewState.IdRef="Sequence_23">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="sd:DataRow" Name="rowNew" />
                          <Variable x:TypeArguments="x:Int32" Name="columnIndex" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-clone表结构" sap:VirtualizedContainerService.HintSize="488,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_19" IsIgnore="False" Text="[{&quot;To&quot;:&quot;outputDataTable&quot;,&quot;ToTypeName&quot;:&quot;System.Data.DataTable, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;outputDataTable.Clone()&quot;,&quot;ValTypeName&quot;:&quot;System.Data.DataTable, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                          <bfa:MultipleAssign.AssignModels>
                            <bfa:AssignModel Index="1" IsNotFirst="False">
                              <bfa:AssignModel.To>
                                <OutArgument x:TypeArguments="sd:DataTable">
                                  <mca:CSharpReference x:TypeArguments="sd:DataTable">outputDataTable</mca:CSharpReference>
                                </OutArgument>
                              </bfa:AssignModel.To>
                              <bfa:AssignModel.Value>
                                <InArgument x:TypeArguments="sd:DataTable">
                                  <mca:CSharpValue x:TypeArguments="sd:DataTable">outputDataTable.Clone()</mca:CSharpValue>
                                </InArgument>
                              </bfa:AssignModel.Value>
                            </bfa:AssignModel>
                          </bfa:MultipleAssign.AssignModels>
                        </bfa:MultipleAssign>
                        <bfa:ForEach x:TypeArguments="sd:DataColumn" ActivityName="循环操作（For Each）" sap2010:Annotation.AnnotationText="设置所有列可为空。不然插入的时候有的自动生成&amp;更新的会报错。" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="For Each-设置所有列可为null" sap:VirtualizedContainerService.HintSize="488,293" sap2010:WorkflowViewState.IdRef="ForEach`1_13" IsIgnore="False">
                          <bfa:ForEach.CurrentIndex>
                            <OutArgument x:TypeArguments="x:Int32">
                              <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_76">columnIndex</mca:CSharpReference>
                            </OutArgument>
                          </bfa:ForEach.CurrentIndex>
                          <bfa:ForEach.Values>
                            <InArgument x:TypeArguments="sd:DataColumnCollection">
                              <mca:CSharpValue x:TypeArguments="sd:DataColumnCollection" sap2010:WorkflowViewState.IdRef="CSharpValue`1_112">outputDataTable.Columns</mca:CSharpValue>
                            </InArgument>
                          </bfa:ForEach.Values>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="sd:DataColumn">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                            </ActivityAction.Argument>
                            <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-设置所有列可为null" sap:VirtualizedContainerService.HintSize="360,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_21" IsIgnore="False" Text="[{&quot;To&quot;:&quot;outputDataTable.Columns[column.ColumnName].AllowDBNull&quot;,&quot;ToTypeName&quot;:&quot;System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;true&quot;,&quot;ValTypeName&quot;:&quot;System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                              <bfa:MultipleAssign.AssignModels>
                                <bfa:AssignModel Index="1" IsNotFirst="False">
                                  <bfa:AssignModel.To>
                                    <OutArgument x:TypeArguments="x:Boolean">
                                      <mca:CSharpReference x:TypeArguments="x:Boolean">outputDataTable.Columns[column.ColumnName].AllowDBNull</mca:CSharpReference>
                                    </OutArgument>
                                  </bfa:AssignModel.To>
                                  <bfa:AssignModel.Value>
                                    <InArgument x:TypeArguments="x:Boolean">
                                      <mca:CSharpValue x:TypeArguments="x:Boolean">true</mca:CSharpValue>
                                    </InArgument>
                                  </bfa:AssignModel.Value>
                                </bfa:AssignModel>
                              </bfa:MultipleAssign.AssignModels>
                            </bfa:MultipleAssign>
                          </ActivityAction>
                        </bfa:ForEach>
                        <bfa:ForEach x:TypeArguments="sd:DataRow" CurrentIndex="{x:Null}" ActivityName="循环操作（For Each）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="For Each-添加数据行" sap:VirtualizedContainerService.HintSize="488,690" sap2010:WorkflowViewState.IdRef="ForEach`1_8" IsIgnore="False">
                          <bfa:ForEach.Values>
                            <InArgument x:TypeArguments="sd:DataRowCollection">
                              <mca:CSharpValue x:TypeArguments="sd:DataRowCollection" sap2010:WorkflowViewState.IdRef="CSharpValue`1_105">数据表.Rows</mca:CSharpValue>
                            </InArgument>
                          </bfa:ForEach.Values>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="sd:DataRow">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="序列" sap:VirtualizedContainerService.HintSize="472,585" sap2010:WorkflowViewState.IdRef="Sequence_24">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-创建新Row" sap:VirtualizedContainerService.HintSize="450,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_17" IsIgnore="False" Text="[{&quot;To&quot;:&quot;rowNew&quot;,&quot;ToTypeName&quot;:&quot;System.Data.DataRow, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;outputDataTable.NewRow()&quot;,&quot;ValTypeName&quot;:&quot;System.Data.DataRow, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                                <bfa:MultipleAssign.AssignModels>
                                  <bfa:AssignModel Index="1" IsNotFirst="False">
                                    <bfa:AssignModel.To>
                                      <OutArgument x:TypeArguments="sd:DataRow">
                                        <mca:CSharpReference x:TypeArguments="sd:DataRow">rowNew</mca:CSharpReference>
                                      </OutArgument>
                                    </bfa:AssignModel.To>
                                    <bfa:AssignModel.Value>
                                      <InArgument x:TypeArguments="sd:DataRow">
                                        <mca:CSharpValue x:TypeArguments="sd:DataRow">outputDataTable.NewRow()</mca:CSharpValue>
                                      </InArgument>
                                    </bfa:AssignModel.Value>
                                  </bfa:AssignModel>
                                </bfa:MultipleAssign.AssignModels>
                              </bfa:MultipleAssign>
                              <bfa:ForEach x:TypeArguments="sd:DataColumn" CurrentIndex="{x:Null}" ActivityName="循环操作（For Each）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="循环操作（For Each）" sap:VirtualizedContainerService.HintSize="450,268" sap2010:WorkflowViewState.IdRef="ForEach`1_10" IsIgnore="False">
                                <bfa:ForEach.Values>
                                  <InArgument x:TypeArguments="sd:DataColumnCollection">
                                    <mca:CSharpValue x:TypeArguments="sd:DataColumnCollection" sap2010:WorkflowViewState.IdRef="CSharpValue`1_106">数据表.Columns</mca:CSharpValue>
                                  </InArgument>
                                </bfa:ForEach.Values>
                                <ActivityAction x:TypeArguments="sd:DataColumn">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="sd:DataColumn" Name="column" />
                                  </ActivityAction.Argument>
                                  <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-Row赋值" sap:VirtualizedContainerService.HintSize="360,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_18" IsIgnore="False" Text="[{&quot;To&quot;:&quot;rowNew[column.ColumnName]&quot;,&quot;ToTypeName&quot;:&quot;System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;row[column.ColumnName]&quot;,&quot;ValTypeName&quot;:&quot;System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                                    <bfa:MultipleAssign.AssignModels>
                                      <bfa:AssignModel Index="1" IsNotFirst="False">
                                        <bfa:AssignModel.To>
                                          <OutArgument x:TypeArguments="x:Object">
                                            <mca:CSharpReference x:TypeArguments="x:Object">rowNew[column.ColumnName]</mca:CSharpReference>
                                          </OutArgument>
                                        </bfa:AssignModel.To>
                                        <bfa:AssignModel.Value>
                                          <InArgument x:TypeArguments="x:Object">
                                            <mca:CSharpValue x:TypeArguments="x:Object">row[column.ColumnName]</mca:CSharpValue>
                                          </InArgument>
                                        </bfa:AssignModel.Value>
                                      </bfa:AssignModel>
                                    </bfa:MultipleAssign.AssignModels>
                                  </bfa:MultipleAssign>
                                </ActivityAction>
                              </bfa:ForEach>
                              <bda1:DataTableAddRowActivity ArrayRow="{x:Null}" ActivityName="添加数据行" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="添加数据行" sap:VirtualizedContainerService.HintSize="450,22" sap2010:WorkflowViewState.IdRef="DataTableAddRowActivity_1">
                                <bda1:DataTableAddRowActivity.DataRow>
                                  <InArgument x:TypeArguments="sd:DataRow">
                                    <mca:CSharpValue x:TypeArguments="sd:DataRow" sap2010:WorkflowViewState.IdRef="CSharpValue`1_108">rowNew</mca:CSharpValue>
                                  </InArgument>
                                </bda1:DataTableAddRowActivity.DataRow>
                                <bda1:DataTableAddRowActivity.DataTable>
                                  <InArgument x:TypeArguments="sd:DataTable">
                                    <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_107">outputDataTable</mca:CSharpValue>
                                  </InArgument>
                                </bda1:DataTableAddRowActivity.DataTable>
                              </bda1:DataTableAddRowActivity>
                            </Sequence>
                          </ActivityAction>
                        </bfa:ForEach>
                        <bfa:MultipleAssign ActivityName="赋值（多个）" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="赋值-数据表赋值" sap:VirtualizedContainerService.HintSize="488,91" sap2010:WorkflowViewState.IdRef="MultipleAssign_20" IsIgnore="False" Text="[{&quot;To&quot;:&quot;数据表&quot;,&quot;ToTypeName&quot;:&quot;System.Data.DataTable, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;,&quot;Val&quot;:&quot;outputDataTable&quot;,&quot;ValTypeName&quot;:&quot;System.Data.DataTable, System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;}]">
                          <bfa:MultipleAssign.AssignModels>
                            <bfa:AssignModel Index="1" IsNotFirst="False">
                              <bfa:AssignModel.To>
                                <OutArgument x:TypeArguments="sd:DataTable">
                                  <mca:CSharpReference x:TypeArguments="sd:DataTable">数据表</mca:CSharpReference>
                                </OutArgument>
                              </bfa:AssignModel.To>
                              <bfa:AssignModel.Value>
                                <InArgument x:TypeArguments="sd:DataTable">
                                  <mca:CSharpValue x:TypeArguments="sd:DataTable">outputDataTable</mca:CSharpValue>
                                </InArgument>
                              </bfa:AssignModel.Value>
                            </bfa:AssignModel>
                          </bfa:MultipleAssign.AssignModels>
                        </bfa:MultipleAssign>
                      </Sequence>
                      <常:打印数据表 sap:VirtualizedContainerService.HintSize="534,22" sap2010:WorkflowViewState.IdRef="打印数据表_4" Level="Info">
                        <常:打印数据表.传入的数据表>
                          <InArgument x:TypeArguments="sd:DataTable">
                            <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_186">数据表</mca:CSharpValue>
                          </InArgument>
                        </常:打印数据表.传入的数据表>
                        <常:打印数据表.数据表名称>
                          <InArgument x:TypeArguments="x:String">
                            <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_35">数据表改为可入库的结构后</Literal>
                          </InArgument>
                        </常:打印数据表.数据表名称>
                      </常:打印数据表>
                      <bda:DatabaseInsertDataActivity ActivityName="插入数据" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="插入数据" sap:VirtualizedContainerService.HintSize="534,58" sap2010:WorkflowViewState.IdRef="DatabaseInsertDataActivity_1">
                        <bda:DatabaseInsertDataActivity.AffectedRows>
                          <OutArgument x:TypeArguments="x:Int32">
                            <mca:CSharpReference x:TypeArguments="x:Int32" sap2010:WorkflowViewState.IdRef="CSharpReference`1_42">affectedRows</mca:CSharpReference>
                          </OutArgument>
                        </bda:DatabaseInsertDataActivity.AffectedRows>
                        <bda:DatabaseInsertDataActivity.DataSheet>
                          <InArgument x:TypeArguments="sd:DataTable">
                            <mca:CSharpValue x:TypeArguments="sd:DataTable" sap2010:WorkflowViewState.IdRef="CSharpValue`1_68">数据表</mca:CSharpValue>
                          </InArgument>
                        </bda:DatabaseInsertDataActivity.DataSheet>
                        <bda:DatabaseInsertDataActivity.ExecuteTimeOut>
                          <InArgument x:TypeArguments="x:TimeSpan">
                            <Literal x:TypeArguments="x:TimeSpan" sap2010:WorkflowViewState.IdRef="Literal`1_53" Value="00:02:00" />
                          </InArgument>
                        </bda:DatabaseInsertDataActivity.ExecuteTimeOut>
                        <bda:DatabaseInsertDataActivity.TableName>
                          <InArgument x:TypeArguments="x:String">
                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_67">System.Convert.ToString(模块与对应数据表名称字典[模块名称])</mca:CSharpValue>
                          </InArgument>
                        </bda:DatabaseInsertDataActivity.TableName>
                      </bda:DatabaseInsertDataActivity>
                      <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="534,58" sap2010:WorkflowViewState.IdRef="LogActivity_12" Level="Info">
                        <baast:LogActivity.LogContent>
                          <InArgument x:TypeArguments="x:String">
                            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_43">System.Convert.ToString("插入行数="+affectedRows)</mca:CSharpValue>
                          </InArgument>
                        </baast:LogActivity.LogContent>
                      </baast:LogActivity>
                    </Sequence>
                  </ActivityAction>
                </bda:ExecuteTransactionActivity.Body>
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
              </bda:ExecuteTransactionActivity>
            </Sequence>
          </ActivityAction>
        </bda:DatabaseConnectActivity.Body>
        <bda:DatabaseConnectActivity.ConnectionString>
          <InArgument x:TypeArguments="x:String">
            <mca:CSharpValue x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="CSharpValue`1_37">System.Convert.ToString(数据库链接文本)</mca:CSharpValue>
          </InArgument>
        </bda:DatabaseConnectActivity.ConnectionString>
      </bda:DatabaseConnectActivity>
    </Sequence>
    <baast:LogActivity ActivityName="写入日志" ContinueOnError="No" DelayAfter="0" DelayBefore="0" DisplayName="写入日志" sap:VirtualizedContainerService.HintSize="628,58" sap2010:WorkflowViewState.IdRef="LogActivity_30" Level="Info">
      <baast:LogActivity.LogContent>
        <InArgument x:TypeArguments="x:String">
          <Literal x:TypeArguments="x:String" sap2010:WorkflowViewState.IdRef="Literal`1_42">=====写入数据库_插入数据表方式，执行结束=====</Literal>
        </InArgument>
      </baast:LogActivity.LogContent>
    </baast:LogActivity>
  </Sequence>
</Activity>